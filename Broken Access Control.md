# Broken Access Control

การควบคุมการเข้าถึงที่ไม่ถูกต้องหรือหละหลวม ทำให้ผู้ใช้งานที่ไม่มีสิทธิ์สามารถเข้าถึงข้อมูลหรือฟังก์ชันที่ควรจำกัดได้

# 1.Hijack Session

การแย่งชิงเซสชัน (Session Hijacking) คือการที่ผู้โจมตีสามารถเข้าครอบครองเซสชันที่ใช้งานได้ของผู้ใช้ที่ถูกต้อง ซึ่งมักจะเกิดจากการขโมยคุกกี้เซสชัน ทำให้ผู้โจมตีสามารถปฏิบัติการใด ๆ ในแอปพลิเคชันได้เหมือนกับว่าเป็นผู้ใช้ที่ถูกต้อง เช่น การทำธุรกรรมทางการเงินหรือการเข้าถึงข้อมูลสำคัญ การป้องกันที่ดีคือการใช้ HTTPS เพื่อลดความเสี่ยงในการถูกขโมยคุกกี้และการตั้งค่าเซสชันที่ปลอดภัย

  - **ตัวอย่าง**
    > สมมติว่าคุณล็อกอินเข้าไปในเว็บแอปพลิเคชัน แล้วมีผู้โจมตีที่สามารถดักจับคุกกี้เซสชันของคุณได้ จากนั้นผู้โจมตีก็สามารถใช้คุกกี้นี้เพื่อเข้าถึงบัญชีของคุณเหมือนกับเป็นคุณเอง

  - **ป้องกันอย่างไร**
    > ใช้ HTTPS เพื่อเข้ารหัสข้อมูลที่ส่งผ่านเครือข่าย และตรวจสอบว่าเซสชันไม่ถูกขโมยโดยการตรวจสอบ IP และ user agent
    
Insecure Direct Object References (IDOR)
Three or more...

---

Hyphens

***

Asterisks

___

Underscores
คืออะไร: การที่ผู้ใช้สามารถเข้าถึงวัตถุหรือข้อมูลโดยตรงผ่านการอ้างอิงที่ไม่ปลอดภัย เช่น ID ใน URL
ตัวอย่าง: สมมติว่าคุณสามารถเข้าถึงโปรไฟล์ของคุณเองได้ผ่าน URL เช่น https://example.com/user?id=123 ถ้าผู้โจมตีเปลี่ยนเลข ID ใน URL เป็น https://example.com/user?id=124 แล้วสามารถเข้าถึงข้อมูลของผู้ใช้คนอื่นได้
ป้องกันอย่างไร: ตรวจสอบสิทธิ์ของผู้ใช้ทุกครั้งที่มีการเข้าถึงข้อมูลหรือวัตถุโดยตรง และไม่ควรใช้อ้างอิงโดยตรงใน URL
Missing Function Level Access Control:

คืออะไร: การขาดการตรวจสอบสิทธิ์ในการเข้าถึงฟังก์ชันต่าง ๆ ในระบบ
ตัวอย่าง: สมมติว่ามีฟังก์ชันที่เฉพาะผู้ดูแลระบบเท่านั้นที่ควรเข้าถึงได้ เช่น การลบผู้ใช้ แต่ผู้ใช้ทั่วไปสามารถเข้าถึง URL ของฟังก์ชันนี้ได้และทำการลบผู้ใช้อื่น ๆ
ป้องกันอย่างไร: กำหนดการตรวจสอบสิทธิ์ในทุกฟังก์ชันที่มีความสำคัญ และตรวจสอบสิทธิ์ของผู้ใช้ก่อนการเข้าถึงฟังก์ชันนั้น ๆ
Spoofing an Authentication Cookie:

คืออะไร: การปลอมแปลงคุกกี้การยืนยันตัวตน เพื่อเข้าถึงระบบในฐานะผู้ใช้ที่ถูกต้อง
ตัวอย่าง: ผู้โจมตีสามารถสร้างหรือแก้ไขคุกกี้ที่เก็บข้อมูลการยืนยันตัวตนเพื่อทำให้ระบบเชื่อว่าผู้โจมตีเป็นผู้ใช้ที่มีสิทธิ์สูงกว่า เช่น ผู้ดูแลระบบ
ป้องกันอย่างไร: ใช้การเข้ารหัสคุกกี้และตรวจสอบความถูกต้องของคุกกี้อย่างสม่ำเสมอ เช่น การใช้ HMAC (Hash-based Message Authentication Code)
