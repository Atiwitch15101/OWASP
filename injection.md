# Injection

Injection คือ การโจมตีที่ผู้ไม่ประสงค์ดีสามารถฝังโค้ดที่ไม่ควรเข้ามาในแอปพลิเคชันของเรา ซึ่งอาจเป็น SQL Injection, Cross-Site Scripting (XSS), หรือชนิดอื่น ๆ โดยตรงผ่านข้อมูลที่ผู้โจมตีส่งเข้ามาผ่านช่องโหว่ที่ไม่ควรเกิดขึ้น

# SQL injection (into) 

การโจมตีชนิดหนึ่งที่ผู้โจมตีส่งข้อมูลที่ไม่ปลอดภัยเข้าสู่ระบบฐานข้อมูลผ่านช่องโหว่ SQL query ของเว็บแอปพลิเคชัน เพื่อให้เกิดการดำเนินการ SQL ที่ไม่ถูกต้องหรือไม่ปลอดภัย

  - **ตัวอย่าง**
    > 1.ผู้โจมตีพบช่องโหว่ SQL Injection (into) ในแอปพลิเคชันที่รับข้อมูลที่ไม่ได้กรองค่าอย่างถูกต้อง เช่น แบบฟอร์มค้นหาที่ไม่มีการกรองข้อมูล
    
    > 2.ผู้โจมตีใส่โค้ด SQL อันตรายเข้าไปในช่องโหว่ เช่น ' OR 1=1 -- ซึ่งจะทำให้คำสั่ง SQL ที่ถูกสร้างขึ้นดูเป็นแบบนี้: SELECT * FROM users WHERE username='' OR 1=1 -- AND password=''
    
    > 3.คำสั่ง SQL ที่ถูกเขียนโดยผู้โจมตีจะส่งคืนข้อมูลทั้งหมดจากตาราง users โดยไม่ต้องการการยืนยันตัวตนหรือรหัสผ่าน
    
    > 4.ผู้โจมตีสามารถเข้าถึงข้อมูลของผู้ใช้ทั้งหมดในฐานข้อมูลหรือทำการปรับเปลี่ยนข้อมูลได้ตามที่ต้องการ

  - **ป้องกันอย่างไร**
    > - ใช้ Parameterized Queries หรือ Prepared Statements ใช้เทคนิคนี้เพื่อป้องกันการฝังข้อมูลไม่ปลอดภัยเข้าไปในคำสั่ง SQL
    > - ตรวจสอบข้อมูลที่รับเข้ามา ตรวจสอบและ validate ข้อมูลที่รับเข้ามาก่อนนำไปใช้งาน
    > - กำหนดสิทธิ์และ Permission ให้เหมาะสม กำหนดสิทธิ์การเข้าถึงข้อมูลและการดำเนินการในฐานข้อมูลให้เหมาะสมตามบทบาทของผู้ใช้งาน
    
___

# SQL Injection (advanced)

เป็นรูปแบบที่ซับซ้อนขึ้นจาก SQL Injection ปกติ โดยมีการใช้เทคนิคแบบ Union Query, Blind SQL Injection, Time-Based Blind SQL Injection เพื่อโจมตีฐานข้อมูลของเว็บไซต์

  - **ตัวอย่าง**
    
    > ค้นหาช่องโหว่ SQL Injection ในเว็บไซต์ เช่น ในช่องค้นหาหรือแบบฟอร์มอื่น ๆ ที่รับข้อมูลจากผู้ใช้งาน
    
    > ใส่โค้ด SQL Injection ลงไปในช่องโหว่ เช่น ' OR 1=1 -- หรือ ' UNION SELECT username, password FROM users --
    
    > ทดสอบการโจมตีโดยดูผลลัพธ์ที่แสดงออกมา เช่น การแสดงข้อมูลผู้ใช้งานหรือการเข้าถึงข้อมูลอื่น ๆ ในฐานข้อมูล

  - **ป้องกันอย่างไร**

    > - **ใช้ Parameterized Queries** ใช้การสร้างคำสั่ง SQL ด้วยพารามิเตอร์เพื่อป้องกันการฝังโค้ด SQL ไม่ปลอดภัย
    
    > - **ตรวจสอบข้อมูล** ตรวจสอบข้อมูลที่รับเข้ามาจากผู้ใช้งานเพื่อระบุว่ามีการแทรกโค้ด SQL หรือไม่
    
    > - **กำหนดสิทธิ์** กำหนดสิทธิ์การเข้าถึงฐานข้อมูลอย่างเหมาะสมเพื่อลดความเสี่ยงจาก SQL Injection
    
    > - **ใช้ WAF (Web Application Firewall)** ใช้ WAF เพื่อตรวจจับและป้องกัน SQL Injection และช่องโหว่ที่เกี่ยวข้องอื่น ๆ
  
___

# SQL injection (mitigation)

การป้องกันช่องโหว่ SQL Injection หรือลดความเสี่ยงจาก SQL Injection ที่อาจเกิดขึ้นในเว็บแอปพลิเคชัน โดยการใช้เทคนิคหรือเครื่องมือที่ช่วยป้องกันช่องโหว่นี้ได้

  - **ตัวอย่าง**
    
  - **ป้องกันอย่างไร**
    
    > - **การใช้ Parameterized Queries หรือ Prepared Statements** นำข้อมูลที่ได้รับมาจากผู้ใช้ใส่ในพารามิเตอร์ของคำสั่ง SQL แทนที่จะตรงๆ เพื่อป้องกันการฝังข้อมูลไม่ปลอดภัยในคำสั่ง SQL     
    > - **การทำ Input Validation** ตรวจสอบและกำหนดเงื่อนไขให้ข้อมูลที่รับเข้ามามีความถูกต้องและเป็นไปตามรูปแบบที่ต้องการ  
    > - **การใช้ ORM (Object-Relational Mapping)** ใช้เทคโนโลยี ORM เพื่อจัดการข้อมูลในฐานข้อมูลโดยไม่ต้องใช้คำสั่ง SQL โดยตรง ซึ่ง ORM มักจะมีการป้องกันช่องโหว่ SQL Injection อย่างมีประสิทธิภาพ
    > - **การใช้ Stored Procedures** ใช้ Stored Procedures ในการดำเนินการกับข้อมูลในฐานข้อมูล ซึ่ง Stored Procedures มักจะถูกคอมไพล์และตรวจสอบก่อนการใช้งานเพื่อป้องกัน SQL Injection ในระดับที่ความเสี่ยงน้อยลง

